# Colors
GREEN   = \033[32;1m
RED     = \033[31;1m
YELLOW  = \033[33;1m
BLUE    = \033[34;1m
MAGENTA = \033[35;1m
CYAN    = \033[36;1m
WHITE   = \033[37;1m
RESET   = \033[0m

# Program name and compiler
NAME        =ex03
CC          = c++
CPPFLAGS    = -Wall -Wextra -Werror -std=c++98

# Source files
SRC         =  main.cpp  Bureaucrat.cpp  AForm.cpp  ShrubberyCreationForm.cpp RobotomyRequestForm.cpp\
			   PresidentialPardonForm.cpp Intern.cpp\

# Object files
OBJ         = $(SRC:.cpp=.o)

# Progress counter
COUNTER     = 0
TOTAL       = $(words $(SRC))

# Main rules
all: banner $(NAME)

banner:
	@echo "$(MAGENTA)"
	@echo "โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ"
	@echo "โ            Bureaucrat               โ"
	@echo "โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ$(RESET)"

$(NAME): $(OBJ)
	@echo "$(YELLOW)\nLinking objects...$(RESET)"
	@$(CC) $(CPPFLAGS) $(OBJ) -o $(NAME)
	@echo "$(GREEN)Build successful! โจ$(RESET)"

%.o: %.cpp $(NAME).hpp Makefile
	@printf "$(CYAN)Compiling [%d/%d] %s...$(RESET)\r" $$(($(COUNTER) + 1)) $(TOTAL) $<
	@$(CC) $(CPPFLAGS) -c $< -o $@
	@$(eval COUNTER=$(shell echo $$(($(COUNTER) + 1))))

clean:
	@echo "$(RED)Cleaning object files...$(RESET)"
	@rm -f $(OBJ)
	@echo "$(GREEN)Clean complete! ๐งน$(RESET)"

fclean: clean
	@echo "$(RED)Removing executable...$(RESET)"
	@rm -f $(NAME)
	@echo "$(GREEN)Full clean complete! ๐งนโจ$(RESET)"

re: fclean all

.PHONY: all clean fclean re banner

help:
	@echo "$(CYAN)Available commands:$(RESET)"
	@echo "$(WHITE)make all    $(BLUE)- Build the program$(RESET)"
	@echo "$(WHITE)make clean  $(BLUE)- Remove object files$(RESET)"
	@echo "$(WHITE)make fclean $(BLUE)- Remove object files and executable$(RESET)"
	@echo "$(WHITE)make re     $(BLUE)- Rebuild the program$(RESET)"